<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/blog/_next/static/css/804aba4b300451b4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/blog/_next/static/chunks/webpack-795968712a2aca95.js"/><script src="/blog/_next/static/chunks/4bd1b696-a9c5a4ce0592c82c.js" async=""></script><script src="/blog/_next/static/chunks/517-928a4a9a0a09df08.js" async=""></script><script src="/blog/_next/static/chunks/main-app-ba56f226a1135110.js" async=""></script><script src="/blog/_next/static/chunks/app/layout-388a71c7789ceb2d.js" async=""></script><script src="/blog/_next/static/chunks/173-9038e5ec5c337389.js" async=""></script><script src="/blog/_next/static/chunks/app/(frontend)/articles/%5BissueNumber%5D/page-9cdd2bbeba283de4.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-41KF9W3KRE" as="script"/><title>canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog</title><meta name="description" content="waonpadのブログです。"/><meta property="og:title" content="canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog"/><meta property="og:description" content="waonpadのブログです。"/><meta property="og:image" content="https://waonpad.github.io/blog/articles/20/opengraph-image.png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:type" content="image/png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog"/><meta name="twitter:description" content="waonpadのブログです。"/><meta name="twitter:image" content="https://waonpad.github.io/blog/articles/20/opengraph-image.png"/><meta name="twitter:image:width" content="1200"/><meta name="twitter:image:height" content="630"/><meta name="twitter:image:type" content="image/png"/><link rel="icon" href="/blog/favicon.ico"/><script src="/blog/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="flex min-h-dvh flex-col"><header class="mx-auto flex w-[95%] max-w-(--breakpoint-lg) items-center py-3"><nav><a class="alternative-link flex items-center font-bold text-lg" href="/blog/"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" class="mr-2 h-6 w-6"><rect x="0" y="0" width="20" height="100" fill="white"></rect><rect x="40" y="0" width="20" height="100" fill="white"></rect><rect x="80" y="0" width="20" height="100" fill="white"></rect></svg>waonpad blog</a></nav><nav class="ml-auto"><ul class="flex items-center gap-6"><li><a class="alternative-link font-medium text-slate-300" href="/blog/about/">About</a></li><li><a class="alternative-link font-medium text-slate-300" href="/blog/tags/">Tags</a></li><li><a href="https://github.com/waonpad" class="alternative-link text-slate-300" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li></ul></nav></header><main class="mx-auto flex w-[95%] max-w-(--breakpoint-lg) grow flex-col py-2"><article class="w-full divide-y divide-[#30363db3]"><section class="markdown"><header><time itemProp="datePublished" dateTime="2024-10-12T16:25:51Z" class="text-gray-400 text-sm ">2024-10-13 01:25</time><h1 class="mt-0!">canvasに画像を描画して千本鳥居を爆速で建築する</h1></header><div><p>キャッキャ \(^o^)/</p>
<p>見栄えを良くしようと思うとめちゃくちゃ面倒くさそうだったのでやーめた</p>
<img width="493" alt="スクリーンショット 2024-10-13 1 19 36" src="https://github.com/user-attachments/assets/102a470a-6c1f-4fb9-a0fa-b3339c4c2de0">
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="typescript" data-theme="github-dark"><code data-language="typescript" data-theme="github-dark" style="display: grid;"><span data-line=""><span style="color:#9ECBFF">"use client"</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">import</span><span style="color:#E1E4E8"> imgFile </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "@/assets/torii.png"</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { </span><span style="color:#F97583">type</span><span style="color:#E1E4E8"> MouseEventHandler, useCallback, useEffect, useRef, useState } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "react"</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">export</span><span style="color:#F97583"> const</span><span style="color:#B392F0"> Component</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#F97583">  const</span><span style="color:#79B8FF"> canvasRef</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> useRef</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">HTMLCanvasElement</span><span style="color:#F97583"> |</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">>(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#F97583">  const</span><span style="color:#79B8FF"> imgRef</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> useRef</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">HTMLImageElement</span><span style="color:#F97583"> |</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">>(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#F97583">  const</span><span style="color:#E1E4E8"> [</span><span style="color:#79B8FF">isDrawing</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">setIsDrawing</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useState</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">  const</span><span style="color:#79B8FF"> loadImg</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> useCallback</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> maxWidth</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 100</span><span style="color:#E1E4E8">; </span><span style="color:#6A737D">// リサイズ後の最大幅</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> maxHeight</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> 100</span><span style="color:#E1E4E8">; </span><span style="color:#6A737D">// リサイズ後の最大高さ</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> originalWidth</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> imgFile.width;</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> originalHeight</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> imgFile.height;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // アスペクト比を維持したままリサイズ</span></span>
<span data-line=""><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> originalWidth;</span></span>
<span data-line=""><span style="color:#F97583">    let</span><span style="color:#E1E4E8"> height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> originalHeight;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (width </span><span style="color:#F97583">></span><span style="color:#E1E4E8"> maxWidth </span><span style="color:#F97583">||</span><span style="color:#E1E4E8"> height </span><span style="color:#F97583">></span><span style="color:#E1E4E8"> maxHeight) {</span></span>
<span data-line=""><span style="color:#F97583">      const</span><span style="color:#79B8FF"> aspectRatio</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> originalWidth </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> originalHeight;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> (width </span><span style="color:#F97583">></span><span style="color:#E1E4E8"> maxWidth) {</span></span>
<span data-line=""><span style="color:#E1E4E8">        width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> maxWidth;</span></span>
<span data-line=""><span style="color:#E1E4E8">        height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> maxWidth </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> aspectRatio;</span></span>
<span data-line=""><span style="color:#E1E4E8">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> (height </span><span style="color:#F97583">></span><span style="color:#E1E4E8"> maxHeight) {</span></span>
<span data-line=""><span style="color:#E1E4E8">        height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> maxHeight;</span></span>
<span data-line=""><span style="color:#E1E4E8">        width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> maxHeight </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> aspectRatio;</span></span>
<span data-line=""><span style="color:#E1E4E8">      }</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 画像を読み込む</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> img</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> Image</span><span style="color:#E1E4E8">(width, height);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    return</span><span style="color:#F97583"> new</span><span style="color:#79B8FF"> Promise</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">HTMLImageElement</span><span style="color:#E1E4E8">>((</span><span style="color:#FFAB70">resolve</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#6A737D">      // 画像が読み込まれたらresolveする</span></span>
<span data-line=""><span style="color:#E1E4E8">      img.</span><span style="color:#B392F0">onload</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#B392F0">        resolve</span><span style="color:#E1E4E8">(img);</span></span>
<span data-line=""><span style="color:#E1E4E8">      };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">      // 画像の読み込みを開始</span></span>
<span data-line=""><span style="color:#E1E4E8">      img.src </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> imgFile.src;</span></span>
<span data-line=""><span style="color:#E1E4E8">    });</span></span>
<span data-line=""><span style="color:#E1E4E8">  }, []);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#B392F0">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#E1E4E8">    (</span><span style="color:#F97583">async</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#F97583">      const</span><span style="color:#79B8FF"> img</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> loadImg</span><span style="color:#E1E4E8">();</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E1E4E8">      imgRef.current </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> img;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E1E4E8">      console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"画像読み込み完了"</span><span style="color:#E1E4E8">, img);</span></span>
<span data-line=""><span style="color:#E1E4E8">    })();</span></span>
<span data-line=""><span style="color:#E1E4E8">  }, [loadImg]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">  const</span><span style="color:#79B8FF"> draw</span><span style="color:#F97583">:</span><span style="color:#B392F0"> MouseEventHandler</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">HTMLCanvasElement</span><span style="color:#E1E4E8">> </span><span style="color:#F97583">=</span><span style="color:#B392F0"> useCallback</span><span style="color:#E1E4E8">((</span><span style="color:#FFAB70">event</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (event.type </span><span style="color:#F97583">===</span><span style="color:#9ECBFF"> "mousedown"</span><span style="color:#E1E4E8">) {</span></span>
<span data-line=""><span style="color:#B392F0">      setIsDrawing</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#E1E4E8">      console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"描画開始"</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">canvasRef.current) {</span></span>
<span data-line=""><span style="color:#F97583">      return</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> ctx</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> canvasRef.current.</span><span style="color:#B392F0">getContext</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"2d"</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">ctx) {</span></span>
<span data-line=""><span style="color:#F97583">      return</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> img</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> imgRef.current;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">img) {</span></span>
<span data-line=""><span style="color:#F97583">      return</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // クリックした位置を画像の中心にする</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> x</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> event.clientX </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> img.width </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#79B8FF"> y</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> event.clientY </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> img.height </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 画像が読み込まれたら描画</span></span>
<span data-line=""><span style="color:#E1E4E8">    ctx.</span><span style="color:#B392F0">drawImage</span><span style="color:#E1E4E8">(img, x, y, img.width, img.height);</span></span>
<span data-line=""><span style="color:#E1E4E8">  }, []);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#B392F0">  useEffect</span><span style="color:#E1E4E8">(() </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">!</span><span style="color:#E1E4E8">isDrawing) {</span></span>
<span data-line=""><span style="color:#F97583">      return</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#E1E4E8">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    const</span><span style="color:#B392F0"> onWindowMouseUp</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#B392F0">      setIsDrawing</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#E1E4E8">      console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"描画終了"</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""><span style="color:#E1E4E8">    };</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#E1E4E8">    window.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"mouseup"</span><span style="color:#E1E4E8">, onWindowMouseUp);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> () </span><span style="color:#F97583">=></span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#E1E4E8">      window.</span><span style="color:#B392F0">removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"mouseup"</span><span style="color:#E1E4E8">, onWindowMouseUp);</span></span>
<span data-line=""><span style="color:#E1E4E8">    };</span></span>
<span data-line=""><span style="color:#E1E4E8">  }, [isDrawing]);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> (</span></span>
<span data-line=""><span style="color:#F97583">    &#x3C;></span></span>
<span data-line=""><span style="color:#F97583">      &#x3C;</span><span style="color:#E1E4E8">canvas ref</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{canvasRef} width</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">500</span><span style="color:#E1E4E8">} height</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{</span><span style="color:#79B8FF">500</span><span style="color:#E1E4E8">} onMouseDown</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{draw} onMouseMove</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">{isDrawing ? draw : </span><span style="color:#79B8FF">undefined</span><span style="color:#E1E4E8">} </span><span style="color:#F97583">/></span></span>
<span data-line=""><span style="color:#F97583">    &#x3C;/></span></span>
<span data-line=""><span style="color:#E1E4E8">  );</span></span>
<span data-line=""><span style="color:#E1E4E8">};</span></span><button type="button" title="Copy code" aria-label="Copy code" data="&#x22;use client&#x22;;

import imgFile from &#x22;@/assets/torii.png&#x22;;
import { type MouseEventHandler, useCallback, useEffect, useRef, useState } from &#x22;react&#x22;;

export const Component = () => {
  const canvasRef = useRef<HTMLCanvasElement | null>(null);
  const imgRef = useRef<HTMLImageElement | null>(null);
  const [isDrawing, setIsDrawing] = useState(false);

  const loadImg = useCallback(async () => {
    const maxWidth = 100; // リサイズ後の最大幅
    const maxHeight = 100; // リサイズ後の最大高さ

    const originalWidth = imgFile.width;
    const originalHeight = imgFile.height;

    // アスペクト比を維持したままリサイズ
    let width = originalWidth;
    let height = originalHeight;

    if (width > maxWidth || height > maxHeight) {
      const aspectRatio = originalWidth / originalHeight;

      if (width > maxWidth) {
        width = maxWidth;
        height = maxWidth / aspectRatio;
      }

      if (height > maxHeight) {
        height = maxHeight;
        width = maxHeight * aspectRatio;
      }
    }

    // 画像を読み込む
    const img = new Image(width, height);

    return new Promise<HTMLImageElement>((resolve) => {
      // 画像が読み込まれたらresolveする
      img.onload = () => {
        resolve(img);
      };

      // 画像の読み込みを開始
      img.src = imgFile.src;
    });
  }, []);

  useEffect(() => {
    (async () => {
      const img = await loadImg();

      imgRef.current = img;

      console.log(&#x22;画像読み込み完了&#x22;, img);
    })();
  }, [loadImg]);

  const draw: MouseEventHandler<HTMLCanvasElement> = useCallback((event) => {
    if (event.type === &#x22;mousedown&#x22;) {
      setIsDrawing(true);
      console.log(&#x22;描画開始&#x22;);
    }

    if (!canvasRef.current) {
      return;
    }

    const ctx = canvasRef.current.getContext(&#x22;2d&#x22;);

    if (!ctx) {
      return;
    }

    const img = imgRef.current;

    if (!img) {
      return;
    }

    // クリックした位置を画像の中心にする
    const x = event.clientX - img.width / 2;
    const y = event.clientY - img.height / 2;

    // 画像が読み込まれたら描画
    ctx.drawImage(img, x, y, img.width, img.height);
  }, []);

  useEffect(() => {
    if (!isDrawing) {
      return;
    }

    const onWindowMouseUp = () => {
      setIsDrawing(false);
      console.log(&#x22;描画終了&#x22;);
    };

    window.addEventListener(&#x22;mouseup&#x22;, onWindowMouseUp);

    return () => {
      window.removeEventListener(&#x22;mouseup&#x22;, onWindowMouseUp);
    };
  }, [isDrawing]);

  return (
    <>
      <canvas ref={canvasRef} width={500} height={500} onMouseDown={draw} onMouseMove={isDrawing ? draw : undefined} />
    </>
  );
};" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure></div></section></article></main><footer class="mx-auto w-[95%] max-w-(--breakpoint-lg) py-4"><nav class="flex flex-col gap-3"><ul class="flex items-center justify-center gap-6"><li><a href="https://github.com/waonpad" class="alternative-link text-slate-300" rel="noopener noreferrer" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li></ul><ul class="flex items-center justify-center gap-6"><li><a class="alternative-link font-medium text-slate-300" href="/blog/">Home</a></li><li><a class="alternative-link font-medium text-slate-300" href="/blog/about/">About</a></li><li><a class="alternative-link font-medium text-slate-300" href="/blog/tags/">Tags</a></li><li><a class="alternative-link font-medium text-slate-300" href="/blog/privacy/">Privacy</a></li></ul></nav></footer><script src="/blog/_next/static/chunks/webpack-795968712a2aca95.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[5244,[],\"\"]\n3:I[3866,[],\"\"]\n4:I[766,[\"177\",\"static/chunks/app/layout-388a71c7789ceb2d.js\"],\"GoogleAnalytics\"]\n5:I[8173,[\"173\",\"static/chunks/173-9038e5ec5c337389.js\",\"585\",\"static/chunks/app/(frontend)/articles/%5BissueNumber%5D/page-9cdd2bbeba283de4.js\"],\"\"]\n9:I[6213,[],\"OutletBoundary\"]\nb:I[6213,[],\"MetadataBoundary\"]\nd:I[6213,[],\"ViewportBoundary\"]\nf:I[4835,[],\"\"]\n:HL[\"/blog/_next/static/css/804aba4b300451b4.css\",\"style\"]\n6:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z7:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5"])</script><script>self.__next_f.push([1,".9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"3q3nHFKBMBP-dNqMY73yX\",\"p\":\"/blog\",\"c\":[\"\",\"articles\",\"20\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"(frontend)\",{\"children\":[\"articles\",{\"children\":[[\"issueNumber\",\"20\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/blog/_next/static/css/804aba4b300451b4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ja\",\"children\":[[\"$\",\"body\",null,{\"className\":\"flex min-h-dvh flex-col\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"$L4\",null,{\"gaId\":\"G-41KF9W3KRE\"}]]}]]}],{\"children\":[\"(frontend)\",[\"$\",\"$1\",\"c\",{\"children\":[null,[[\"$\",\"header\",null,{\"className\":\"mx-auto flex w-[95%] max-w-(--breakpoint-lg) items-center py-3\",\"children\":[[\"$\",\"nav\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"alternative-link flex items-center font-bold text-lg\",\"children\":[[\"$\",\"svg\",null,{\"viewBox\":\"0 0 100 100\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"mr-2 h-6 w-6\",\"children\":[[\"$\",\"rect\",null,{\"x\":0,\"y\":0,\"width\":20,\"height\":100,\"fill\":\"white\"}],[\"$\",\"rect\",null,{\"x\":40,\"y\":0,\"width\":20,\"height\":100,\"fill\":\"white\"}],[\"$\",\"rect\",null,{\"x\":80,\"y\":0,\"width\":20,\"height\":100,\"fill\":\"white\"}]]}],\"waonpad blog\"]}]}],[\"$\",\"nav\",null,{\"className\":\"ml-auto\",\"children\":[\"$\",\"ul\",null,{\"className\":\"flex items-center gap-6\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/about\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"About\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/tags\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"Tags\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/waonpad\",\"className\":\"alternative-link text-slate-300\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$6\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":18,\"width\":18,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}]]}]}]]}],[\"$\",\"main\",null,{\"className\":\"mx-auto flex w-[95%] max-w-(--breakpoint-lg) grow flex-col py-2\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(frontend)\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:0:props:children:props:notFound:1:1:props:style\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$0:f:0:1:1:props:children:1:props:children:0:props:children:props:notFound:1:1:props:children:props:children:1:props:style\",\"children\":404}],[\"$\",\"div\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:0:props:children:props:notFound:1:1:props:children:props:children:2:props:style\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$0:f:0:1:1:props:children:1:props:children:0:props:children:props:notFound:1:1:props:children:props:children:2:props:children:props:style\",\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"mx-auto w-[95%] max-w-(--breakpoint-lg) py-4\",\"children\":[\"$\",\"nav\",null,{\"className\":\"flex flex-col gap-3\",\"children\":[[\"$\",\"ul\",null,{\"className\":\"flex items-center justify-center gap-6\",\"children\":[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/waonpad\",\"className\":\"alternative-link text-slate-300\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$7\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":18,\"width\":18,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}]}],[\"$\",\"ul\",null,{\"className\":\"flex items-center justify-center gap-6\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"Home\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/about\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"About\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/tags\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"Tags\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L5\",null,{\"href\":\"/privacy\",\"className\":\"alternative-link font-medium text-slate-300\",\"children\":\"Privacy\"}]}]]}]]}]}]]]}],{\"children\":[\"articles\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(frontend)\",\"children\",\"articles\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"issueNumber\",\"20\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(frontend)\",\"children\",\"articles\",\"children\",\"$0:f:0:1:2:children:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L8\",null,[\"$\",\"$L9\",null,{\"children\":\"$La\"}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"96pJpTXe-EuGkHEof9DO7\",{\"children\":[[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"waonpadのブログです。\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:title\",\"content\":\"canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:description\",\"content\":\"waonpadのブログです。\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:image\",\"content\":\"https://waonpad.github.io/blog/articles/20/opengraph-image.png\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:image:type\",\"content\":\"image/png\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:title\",\"content\":\"canvasに画像を描画して千本鳥居を爆速で建築する | waonpad blog\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:description\",\"content\":\"waonpadのブログです。\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:image\",\"content\":\"https://waonpad.github.io/blog/articles/20/opengraph-image.png\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image:type\",\"content\":\"image/png\"}],[\"$\",\"link\",\"16\",{\"rel\":\"icon\",\"href\":\"/blog/favicon.ico\"}]]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"10:T599c,"])</script><script>self.__next_f.push([1,"\u003cp\u003eキャッキャ \\(^o^)/\u003c/p\u003e\n\u003cp\u003e見栄えを良くしようと思うとめちゃくちゃ面倒くさそうだったのでやーめた\u003c/p\u003e\n\u003cimg width=\"493\" alt=\"スクリーンショット 2024-10-13 1 19 36\" src=\"https://github.com/user-attachments/assets/102a470a-6c1f-4fb9-a0fa-b3339c4c2de0\"\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre tabindex=\"0\" data-language=\"typescript\" data-theme=\"github-dark\"\u003e\u003ccode data-language=\"typescript\" data-theme=\"github-dark\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"use client\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e imgFile \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"@/assets/torii.png\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e { \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e MouseEventHandler, useCallback, useEffect, useRef, useState } \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003efrom\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"react\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003eexport\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e const\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e Component\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e canvasRef\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e useRef\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eHTMLCanvasElement\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e |\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e null\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003enull\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e imgRef\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e useRef\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eHTMLImageElement\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e |\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e null\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003enull\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eisDrawing\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003esetIsDrawing\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e] \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e useState\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003efalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e loadImg\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e useCallback\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003easync\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e maxWidth\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 100\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e; \u003c/span\u003e\u003cspan style=\"color:#6A737D\"\u003e// リサイズ後の最大幅\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e maxHeight\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 100\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e; \u003c/span\u003e\u003cspan style=\"color:#6A737D\"\u003e// リサイズ後の最大高さ\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e originalWidth\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e imgFile.width;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e originalHeight\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e imgFile.height;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e    // アスペクト比を維持したままリサイズ\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    let\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e originalWidth;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    let\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e originalHeight;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxWidth \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e||\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxHeight) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e aspectRatio\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e originalWidth \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e originalHeight;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxWidth) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxWidth;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxWidth \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e aspectRatio;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxHeight) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxHeight;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e        width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e maxHeight \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e aspectRatio;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e    // 画像を読み込む\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e img\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e Image\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(width, height);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e Promise\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eHTMLImageElement\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u003e((\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eresolve\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e      // 画像が読み込まれたらresolveする\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      img.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eonload\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#B392F0\"\u003e        resolve\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(img);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      };\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e      // 画像の読み込みを開始\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      img.src \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e imgFile.src;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    });\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e  }, []);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#B392F0\"\u003e  useEffect\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(() \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    (\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003easync\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e img\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e await\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e loadImg\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      imgRef.current \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e img;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      console.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003elog\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"画像読み込み完了\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, img);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    })();\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e  }, [loadImg]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e draw\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e MouseEventHandler\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eHTMLCanvasElement\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e\u003e \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e useCallback\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e((\u003c/span\u003e\u003cspan style=\"color:#FFAB70\"\u003eevent\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (event.type \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e===\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e \"mousedown\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#B392F0\"\u003e      setIsDrawing\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003etrue\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      console.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003elog\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"描画開始\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003ecanvasRef.current) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e ctx\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e canvasRef.current.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003egetContext\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"2d\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003ectx) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e img\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e imgRef.current;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eimg) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e    // クリックした位置を画像の中心にする\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e x\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e event.clientX \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e img.width \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e y\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e event.clientY \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e img.height \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#6A737D\"\u003e    // 画像が読み込まれたら描画\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    ctx.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003edrawImage\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(img, x, y, img.width, img.height);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e  }, []);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#B392F0\"\u003e  useEffect\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(() \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e!\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003eisDrawing) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003e onWindowMouseUp\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#B392F0\"\u003e      setIsDrawing\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003efalse\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      console.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003elog\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"描画終了\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    window.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eaddEventListener\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"mouseup\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, onWindowMouseUp);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e () \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e      window.\u003c/span\u003e\u003cspan style=\"color:#B392F0\"\u003eremoveEventListener\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#9ECBFF\"\u003e\"mouseup\"\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e, onWindowMouseUp);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e  }, [isDrawing]);\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e  return\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e (\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    \u0026#x3C;\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e      \u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003ecanvas ref\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{canvasRef} width\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e500\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e} height\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003e500\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e} onMouseDown\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{draw} onMouseMove\u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e{isDrawing ? draw : \u003c/span\u003e\u003cspan style=\"color:#79B8FF\"\u003eundefined\u003c/span\u003e\u003cspan style=\"color:#E1E4E8\"\u003e} \u003c/span\u003e\u003cspan style=\"color:#F97583\"\u003e/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#F97583\"\u003e    \u0026#x3C;/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e  );\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color:#E1E4E8\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003cbutton type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"\u0026#x22;use client\u0026#x22;;\n\nimport imgFile from \u0026#x22;@/assets/torii.png\u0026#x22;;\nimport { type MouseEventHandler, useCallback, useEffect, useRef, useState } from \u0026#x22;react\u0026#x22;;\n\nexport const Component = () =\u003e {\n  const canvasRef = useRef\u003cHTMLCanvasElement | null\u003e(null);\n  const imgRef = useRef\u003cHTMLImageElement | null\u003e(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n\n  const loadImg = useCallback(async () =\u003e {\n    const maxWidth = 100; // リサイズ後の最大幅\n    const maxHeight = 100; // リサイズ後の最大高さ\n\n    const originalWidth = imgFile.width;\n    const originalHeight = imgFile.height;\n\n    // アスペクト比を維持したままリサイズ\n    let width = originalWidth;\n    let height = originalHeight;\n\n    if (width \u003e maxWidth || height \u003e maxHeight) {\n      const aspectRatio = originalWidth / originalHeight;\n\n      if (width \u003e maxWidth) {\n        width = maxWidth;\n        height = maxWidth / aspectRatio;\n      }\n\n      if (height \u003e maxHeight) {\n        height = maxHeight;\n        width = maxHeight * aspectRatio;\n      }\n    }\n\n    // 画像を読み込む\n    const img = new Image(width, height);\n\n    return new Promise\u003cHTMLImageElement\u003e((resolve) =\u003e {\n      // 画像が読み込まれたらresolveする\n      img.onload = () =\u003e {\n        resolve(img);\n      };\n\n      // 画像の読み込みを開始\n      img.src = imgFile.src;\n    });\n  }, []);\n\n  useEffect(() =\u003e {\n    (async () =\u003e {\n      const img = await loadImg();\n\n      imgRef.current = img;\n\n      console.log(\u0026#x22;画像読み込み完了\u0026#x22;, img);\n    })();\n  }, [loadImg]);\n\n  const draw: MouseEventHandler\u003cHTMLCanvasElement\u003e = useCallback((event) =\u003e {\n    if (event.type === \u0026#x22;mousedown\u0026#x22;) {\n      setIsDrawing(true);\n      console.log(\u0026#x22;描画開始\u0026#x22;);\n    }\n\n    if (!canvasRef.current) {\n      return;\n    }\n\n    const ctx = canvasRef.current.getContext(\u0026#x22;2d\u0026#x22;);\n\n    if (!ctx) {\n      return;\n    }\n\n    const img = imgRef.current;\n\n    if (!img) {\n      return;\n    }\n\n    // クリックした位置を画像の中心にする\n    const x = event.clientX - img.width / 2;\n    const y = event.clientY - img.height / 2;\n\n    // 画像が読み込まれたら描画\n    ctx.drawImage(img, x, y, img.width, img.height);\n  }, []);\n\n  useEffect(() =\u003e {\n    if (!isDrawing) {\n      return;\n    }\n\n    const onWindowMouseUp = () =\u003e {\n      setIsDrawing(false);\n      console.log(\u0026#x22;描画終了\u0026#x22;);\n    };\n\n    window.addEventListener(\u0026#x22;mouseup\u0026#x22;, onWindowMouseUp);\n\n    return () =\u003e {\n      window.removeEventListener(\u0026#x22;mouseup\u0026#x22;, onWindowMouseUp);\n    };\n  }, [isDrawing]);\n\n  return (\n    \u003c\u003e\n      \u003ccanvas ref={canvasRef} width={500} height={500} onMouseDown={draw} onMouseMove={isDrawing ? draw : undefined} /\u003e\n    \u003c/\u003e\n  );\n};\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);window.setTimeout(() =\u003e this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;), 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e"])</script><script>self.__next_f.push([1,"8:[\"$\",\"article\",null,{\"className\":\"w-full divide-y divide-[#30363db3]\",\"children\":[[\"$\",\"section\",null,{\"className\":\"markdown\",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"time\",null,{\"itemProp\":\"datePublished\",\"dateTime\":\"2024-10-12T16:25:51Z\",\"className\":\"text-gray-400 text-sm \",\"children\":\"2024-10-13 01:25\"}],[\"$\",\"h1\",null,{\"className\":\"mt-0!\",\"children\":\"canvasに画像を描画して千本鳥居を爆速で建築する\"}],false]}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$10\"}}]]}],[]]}]\n"])</script></body></html>